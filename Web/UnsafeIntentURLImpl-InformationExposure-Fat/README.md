# Summary
Apps that do not safely handle an incoming intent embedded inside a URI are vulnerable to information exposure via intent hijacking.

# Android versions affected
Tested on Android 5.1.1

# Description of vulnerability and corresponding exploit
Android allows a webpage displayed in an Android app to launch an Android component via an intent. A webpage X needs to encode the intent as a valid URI U and load it into a component C that displays X. When the user interacts with the webpage X and takes an action that loads the resource pointed to by U.  

*Issue:* If an app has a component C that displays web pages and that component does not sanitize the URI before acting on it then a malicious web page could embed an intent to a malicious component installed in the device. When the user interacts with the URI, she ends up interacting with the malicious component.

*Example:* This vulnerability is present in Opera, where a user can end up opening a malicious Android component by opening a malicious website and clicking on an intent url. Unlike the Lean benchmark, Opera does not send secure information when the exploit is activated. 

# Steps to build the apps and to exploit the vulnerability

1. Setup a local Web Server. We have used Flask here. If you want to use Flask follow the instructions [here](https://bitbucket.org/secure-it-i/android-app-vulnerability-benchmarks/src/master/Misc/LocalServer/](https://bitbucket.org/secure-it-i/android-app-vulnerability-benchmarks/src/master/Misc/LocalServer/).

2. List targets:

    `$ avdmanager list targets`

3. List available Android Virtual Devices:

    `$ avdmanager list avd`

4. Create an emulator:

    `$ avdmanager create avd -n <name> -k <target>`

    *<target>* is obtained from the command listed in 1. *<name>* is the name you choose to give to the avd.
	
	Be sure the emulator you create uses ARM architecture for the App to work. 

5. Start emulator:

    `$ emulator -avd <avd_name>`

    *<avd-name>* is obtained from the command listed in 3.


6. Build and install *Opera*:

    `$ cd Benign`
	`$ adb install com.opera.browser`


7. Build and install *Malicious*:

    `$ cd Malicious`

    Make sure there is a file called local.properties with an entry sdk=/path/to/Android/sdk.

    `$ ./gradlew installApi[VERSION]Debug`

8. Open *Opera* and type the URL "http://serverIP:5000/intent/". Click on the link *Click Me*.

    You will see the app *Malicious* launched


# References

1. [Android Intents with Chrome](https://developer.chrome.com/multidevice/android/intents)

2. [Issue 55](https://bitbucket.org/secure-it-i/android-app-vulnerability-benchmarks/issues/55/explore-cve-2014-1506-to-add-new-lean-and)
